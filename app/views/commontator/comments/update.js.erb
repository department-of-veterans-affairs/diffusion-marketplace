var reloadWithTurbolinks = (function () {
  var scrollPosition;

  function reload () {
      $(window).scroll(function() {
          sessionStorage.scrollTop = $(this).scrollTop();
      });

      $(document).ready(function() {
          if (sessionStorage.scrollTop != "undefined") {
              $(window).scrollTop(sessionStorage.scrollTop);
          }
      });
  }

  document.addEventListener('turbolinks:load', function () {
    if (scrollPosition) {
      window.scrollTo.apply(window, scrollPosition);
      scrollPosition = null;
    }
    $('.timeago').timeago();
    $('#dm-practice-nav').sticky( {topSpacing: 20, zIndex: 10000, bottomSpacing: 200});
  })
    return reload
})()

<%=
  render partial: 'show', locals: {
    user: @commontator_user,
    thread: @commontator_thread,
    comment: @comment,
    page: @commontator_page,
    show_all: @commontator_show_all
  }
%>

$('.timeago').timeago();

<%= javascript_proc %>

<% if params[:refresh_page] %>
  reloadWithTurbolinks();

  <% if @comment.parent_id %>
  $(document).on('turbolinks:load', function() {
    $('#commontator-comment-<%= @comment.id %>').parent().removeClass('hidden');
  })
  <% end %>
<% end %>