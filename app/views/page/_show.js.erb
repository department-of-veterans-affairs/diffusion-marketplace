<% provide :head_tags do %>
  <%= javascript_include_tag 'ie', 'data-turbolinks-track': 'reload' %>
<% end %>

function detectChrome() {
    return /chrome/.test(navigator.userAgent.toLowerCase());
}

function browsePageBuilderPageHappy() {
    var has_warning_banner = <%= @page.has_chrome_warning_banner %>

    if (!detectChrome() && !$('.browsehappy').length && has_warning_banner == true) {
        pageChromeWarningBanner();
    }
}

function containerizeSubpageHyperlinkCards() {

    function addContainerAndAppendElements(container, elementOne, elementTwo) {
        elementOne.before(container);
        elementOne.prev().append(elementOne, elementTwo);
    }

    $('.dm-page-content').children().each(function() {
        var ele = $(this);
        var prevEle = ele.prev();
        var nextEle = ele.next();
        var cardClass = 'usa-card';
        var containerDiv = "<div class='grid-row grid-gap-6'></div>";

        if (ele.hasClass(cardClass) && prevEle.hasClass(cardClass)) {
            addContainerAndAppendElements(containerDiv, prevEle, ele);
        } else if (ele.hasClass(cardClass) && nextEle.hasClass(cardClass)) {
            addContainerAndAppendElements(containerDiv, ele, nextEle);
        }
    });

}

function executePageBuilderFunctions() {
    browsePageBuilderPageHappy();
    containerizeSubpageHyperlinkCards();
}

$(document).on('turbolinks:load', executePageBuilderFunctions);