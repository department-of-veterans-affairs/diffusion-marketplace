<%# debugger %>

$('.usa-alert:not(.pii-phi-alert)').remove();
$(".sidenav-adoptions-link").find('i').addClass('green-check');
$("#adoptions").html("<%= escape_javascript(render partial: 'adoptions_content', formats: [ :html ]) %>");
<% if params[:exists] %>
  $('#adoption_form_container').removeClass('display-none');
  $('.parent-adoption-accordion').each(function() {
    $(this).find('div').first().attr('hidden', true);
  })
<% elsif params[:created] %>
  $('#adoption_form_container').addClass('display-none');
  $('.parent-adoption-accordion').each(function() {
      $(this).find('div').first().attr('hidden', true);
  })
<% else %>
  $('.usa-accordion__content').attr('hidden', true);
<% end %>

<% if @dh && params[:facility_changed] %>
  $('.parent-adoption-accordion').each(function() {
      if (!$(this).find('#diffusion_history_<%= @dh.id %>').length) {
          $(this).find('div').first().attr('hidden', true);
      } else {
          $(this).find('.parent-accordion-button').attr('aria-expanded', true);
          $(this).find('div').first().attr('hidden', false);
          var newTop = $("button[aria-controls='diffusion_history_<%= @dh.id %>']").offset().top - 100
          scrollTo(0, newTop);
      }
  })
<% end %>

<% if params[:existing_dh] %>
  $("button[aria-controls='diffusion_history_<%= @dh.id %>']").attr('aria-expanded', true);
  $('#diffusion_history_<%= @dh.id %>').attr('hidden', false);
  $('.parent-adoption-accordion').each(function() {
    if (!$(this).find('#diffusion_history_<%= @dh.id %>').length) {
        $(this).find('div').first().attr('hidden', true);
    } else {
        $(this).find('button').attr('aria-expanded', true);
        $(this).find('div').first().attr('hidden', false);
        $(this).find('.child-accordion-button').not("button[aria-controls='diffusion_history_<%= @dh.id %>']").each(function() {
            $(this).attr('aria-expanded', false)
        })
    }
  })
<% end %>
