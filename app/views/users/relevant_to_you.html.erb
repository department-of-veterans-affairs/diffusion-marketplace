<% provide :head_tags do %>
  <%= javascript_include_tag '_practice_utilities', 'data-turbolinks-track': 'reload' %>
<% end %>

<div id="relevant-to-you" class="usa-section p0-top p0-bottom grid-container">
  <div class="grid-col-12">
    <div class="rect-svg-blue-30v border-top-1 margin-top-10"></div>
    <h1 class="margin-top-2 margin-bottom-10 usa-prose-h1 font-sans-2xl line-height-46px">Relevant to you</h1>
    <% if @paginated_favorite_practices.any? %>
      <section class="relevant-favorite-practices">
        <%= render partial: 'users/relevant_to_you/practice_cards_container', locals: {
            container_classes: "paginated-favorite-practices margin-top-0",
            container_header_classes: 'usa-prose-h2 font-sans-xl line-height-37px margin-bottom-105',
            container_title: 'Your bookmarked practices',
            practice_data_set: @paginated_favorite_practices
        }
        %>
        <% link = pagy_link_proc(@pagy_favorite_practices) %>
        <%=  link.call(@pagy_favorite_practices.vars[:page] + 1, 'Load more', 'class="margin-bottom-10"').html_safe  if @pagy_favorite_practices.count > 3 %>
      </section>
    <% end %>

    <section class="relevant-user-location-practices">
      <h2 class="usa-prose-h2 font-sans-xl line-height-37px <%= @user_location_practices.any? ? 'margin-bottom-105' : 'margin-bottom-3' %> margin-top-0">
        Based on your location
      </h2>
      <% user_location_practice_count = @user_location_practices.count %>
      <% if @user_location_practices.any? %>
        <%= render partial: 'users/relevant_to_you/practice_cards_container', locals: {
            container_classes: "user-location-practices #{user_location_practice_count > 3 ? 'margin-bottom-105' : ''}",
            container_header_classes: nil,
            container_title: nil,
            practice_data_set: @user_location_practices.first(3)
        }
        %>
        <% if user_location_practice_count > 3 %>
          <a href="/search?query=<%= @user.location %>" class="dm-external-link margin-bottom-5" title="See more practices based on your location">
            See more practices
          </a>
        <% end %>
      <% else %>
        <p class="usa-prose-body line-height-26 margin-bottom-1">You donâ€™t have a location listed in GAL yet.</p>
        <a href="https://yourit.va.gov" class="margin-bottom-5 dm-external-link usa-link--external line-height-26" title="Link to YourIT">Submit a ticket to YourIT</a>
      <% end %>
    </section>
  </div>
</div>