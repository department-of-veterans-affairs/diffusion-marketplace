<%
  action = params[:action]
  controller = params[:controller]
%>

<section class="grid-container<%= ' display-none' if (controller == 'page' && params[:page_slug].nil?) || (controller == 'page' && @builder_landing_page.nil?) %>">
  <div id="breadcrumbs" class="grid-col-auto usa-breadcrumb breadcrumbs-container font-sans-3xs" aria-label="Breadcrumbs">
    <ol class="usa-breadcrumb__list">
      <% if !(controller === 'home' && action === 'index') && controller != 'page' %>
        <li class="usa-breadcrumb__list-item">
          <a href="/" class="usa-breadcrumb__link">Home</a>
        </li>
      <% end %>
      <%
        breadcrumbs = session[:breadcrumbs]
      %>

      <% breadcrumbs.each_with_index do |b, i| %>
        <%
          last_crumb = breadcrumbs.size - 1 == i
        %>

          <%# Check if the page is a page-builder page using the controller and action names %>
          <% if !last_crumb && controller == 'page' && action == 'show' && @builder_landing_page.present? %>
            <%= render partial: 'shared/link_breadcrumb', locals: {breadcrumb: b} %>
          <% elsif !last_crumb && b['display'] == 'Edit' %>
            <%= render partial: 'shared/link_breadcrumb', locals: {breadcrumb: b} %>
          <% elsif !last_crumb && params[:controller] != 'page' %>
            <%= render partial: 'shared/link_breadcrumb', locals: {breadcrumb: b} %>
          <% elsif last_crumb && b['display'] == 'Edit' %>
            <%= render partial: 'shared/text_breadcrumb', locals: {breadcrumb: b} %>
          <% else %>
            <%= render partial: 'shared/text_breadcrumb', locals: {breadcrumb: b} unless params[:controller] === 'page' %>
          <% end %>
        <% end %>
    </ol>
  </div>
</section>